---
import Layout from "../layouts/Layout.astro";
import { emoticons } from "../data/emoticons";
import EmoticonCard from "../components/EmoticonCard.astro";
---

<Layout>
  <main>
    {
      emoticons.map((emoticon) => (
        <EmoticonCard client:visible emoticon={emoticon} />
      ))
    }
  </main>
</Layout>

<script is:inline>
  document.addEventListener("click", async (e) => {
    const button = e.target.closest(".copy-button");
    if (!button) return;

    const card = button.closest(".card");
    if (!card) return;

    const text = card.dataset.emoticon;
    if (!text) return;

    await navigator.clipboard.writeText(text);

    card.dataset.copied = "true";
    button.querySelector(".label").textContent = "Copied!";

    setTimeout(() => {
      card.dataset.copied = "false";
      button.querySelector(".label").textContent = "Copy";
    }, 1500);
  });
</script>

<style>
  main {
    display: grid;
    gap: 16px;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  }
</style>
